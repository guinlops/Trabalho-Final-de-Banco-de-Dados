CREATE DATABASE BD_GRUPO5;
USE BD_GRUPO5;

CREATE TABLE PESSOA(
	CPF VARCHAR(11),
	P_NOME VARCHAR(50),
	U_NOME VARCHAR(50),
	CEP VARCHAR(9), 
	NUMERO INTEGER NOT NULL, 
	RUA VARCHAR(50),
	PRIMARY KEY(CPF)
);


CREATE TABLE TELEFONES(
	TELEFONE VARCHAR(15),
	CPF VARCHAR(11),
	PRIMARY KEY(CPF),
	FOREIGN KEY(CPF) REFERENCES PESSOA(CPF)
);


CREATE TABLE TRANSFERENCIAS_IN( 
	NUM_CONTA_DE INTEGER NOT NULL,
 	NUM_CONTA_PARA INTEGER NOT NULL,
	ID INTEGER NOT NULL AUTO_INCREMENT UNIQUE,
	TAXA DECIMAL(10,2),
	VALOR DECIMAL(10,2),
	DATA DATE, 
	PRIMARY KEY(ID)
);

CREATE TABLE CONTA_EX(
	NUM_CONTA_EX INTEGER NOT NULL,
	BANCO_EX VARCHAR(20),
	TIPO VARCHAR(10)
);

CREATE TABLE TRANSFERENCIAS_EX( 
	NUM_CONTA_DE INTEGER NOT NULL,
 	NUM_CONTA_PARA INTEGER NOT NULL,
	ID INTEGER NOT NULL AUTO_INCREMENT UNIQUE,
	TAXA DECIMAL(10,2),
	VALOR DECIMAL(10,2),
	DATA DATE, 
	PRIMARY KEY(ID)
);

CREATE TABLE FUNCIONARIOS( 
	ID_FUNCIONARIO INTEGER NOT NULL UNIQUE,
	SALARIO DECIMAL(10,2),
	DATA_INICIO DATE,
	CPF VARCHAR(11),
	PRIMARY KEY(ID_FUNCIONARIO),
	AGENCIA VARCHAR(5),
	FOREIGN KEY(CPF) REFERENCES PESSOA(CPF)
);



CREATE TABLE AGENCIAS(
	NUMERO_AGENCIA VARCHAR(5), 
	CEP VARCHAR(9), 
	RUA VARCHAR(50),
	NUMERO INTEGER NOT NULL,
	ID_GERENTE INTEGER NOT NULL,
	PRIMARY KEY(NUMERO_AGENCIA),
	FOREIGN KEY(ID_GERENTE) REFERENCES FUNCIONARIOS(ID_FUNCIONARIO)
);

ALTER TABLE FUNCIONARIOS ADD FOREIGN KEY (AGENCIA) REFERENCES AGENCIAS(NUMERO_AGENCIA);	

CREATE TABLE GESTORES_DE_INVESTIMENTOS(
	ID_FUNCIONARIO INTEGER NOT NULL ,
	BONUS_TAXA DECIMAL(10,2),
	PRIMARY KEY(ID_FUNCIONARIO),
	FOREIGN KEY (ID_FUNCIONARIO) REFERENCES FUNCIONARIOS(ID_FUNCIONARIO)
);
CREATE TABLE GESTORES_DE_SEGUROS(
	ID_FUNCIONARIO INTEGER NOT NULL ,
	BONUS_MENSAL DECIMAL(10,2),
	PRIMARY KEY(ID_FUNCIONARIO),
	FOREIGN KEY (ID_FUNCIONARIO) REFERENCES FUNCIONARIOS(ID_FUNCIONARIO)
);

CREATE TABLE VENDEDORES (
	ID_FUNCIONARIO INTEGER NOT NULL ,
	BONUS_MENSAL DECIMAL(10,2),
	PRIMARY KEY(ID_FUNCIONARIO),
	FOREIGN KEY (ID_FUNCIONARIO) REFERENCES FUNCIONARIOS(ID_FUNCIONARIO)
);
CREATE TABLE CLIENTE(
	CPF VARCHAR(11),
	PRIMARY KEY(CPF),
	FOREIGN KEY(CPF) REFERENCES PESSOA(CPF)
);
CREATE TABLE TIPOS_INVESTIMENTOS(
	ID_INVESTIMENTO INTEGER NOT NULL,
	TEMPO_MIN INTEGER NOT NULL,
	TAXA DECIMAL(10,2),
	EMP_GESTORA VARCHAR(20),
	RETORNO DECIMAL(5,2),
	TIPO VARCHAR(10),
	PRIMARY KEY(ID_INVESTIMENTO)
);
CREATE TABLE INVESTIMENTOS( 
	COD_CONTRATO INTEGER NOT NULL AUTO_INCREMENT UNIQUE,
	DATA_INICIO DATE,
	VALOR_INICIAL DECIMAL(10,2),
	VALOR_ATUAL DECIMAL(10,2),
	GESTOR INTEGER NOT NULL,
	VENDIDO_POR INTEGER NOT NULL,
	TIPO_ID INTEGER NOT NULL,
	CPF_CLIENTE VARCHAR(11),
	PRIMARY KEY(COD_CONTRATO),
	FOREIGN KEY(GESTOR) REFERENCES GESTORES_DE_INVESTIMENTOS(ID_FUNCIONARIO),
	FOREIGN KEY(VENDIDO_POR) REFERENCES VENDEDORES(ID_FUNCIONARIO),
	FOREIGN KEY(TIPO_ID) REFERENCES TIPOS_INVESTIMENTOS(ID_INVESTIMENTO),
	FOREIGN KEY(CPF_CLIENTE) REFERENCES CLIENTE(CPF)
);


CREATE TABLE TIPOS_DE_SEGUROS(
	ID_SEGURO INTEGER NOT NULL UNIQUE,
	CUSTO_ANUAL DECIMAL(10,2),
	TAXA_MENSAL DECIMAL(10,2),
	TIPO VARCHAR(10),
	PRIMARY KEY(ID_SEGURO)
);
CREATE TABLE SEGUROS(
	COD_CONTRATO INTEGER NOT NULL,
	DATA_INICIO DATE,
 	CPF_CLIENTE VARCHAR(11),
	VENDIDO_POR INTEGER NOT NULL,
	ID INTEGER NOT NULL,
	GESTOR INTEGER NOT NULL,
	PRIMARY KEY(COD_CONTRATO),
	FOREIGN KEY(CPF_CLIENTE) REFERENCES CLIENTE(CPF),
	FOREIGN KEY(VENDIDO_POR) REFERENCES VENDEDORES(ID_FUNCIONARIO),
 	FOREIGN KEY(ID) REFERENCES TIPOS_DE_SEGUROS(ID_SEGURO),
	FOREIGN KEY(GESTOR) REFERENCES GESTORES_DE_SEGUROS(ID_FUNCIONARIO)
);
CREATE TABLE EMPRESTIMOS ( 
	COD_CONTRATO INTEGER NOT NULL,
	TAXA_JUROS DECIMAL(4,2),
	DATA_PAGAMENTO_MENSAL DATE,
	NUM_PARCELAS INTEGER NOT NULL,
	PARCELAS_PAGAS INTEGER NOT NULL,
	DATA_INICIO DATE,
	CPF_CLIENTE VARCHAR(11),
	MULTA_ATRASO DECIMAL(10,2),
	FOREIGN KEY(CPF_CLIENTE) REFERENCES CLIENTE(CPF)
);

CREATE TABLE CONTA_CORRENTE(
	 NUM_CONTA_C VARCHAR(11) UNIQUE,
	 DATA_ABERTURA DATE,
	 SALDO DECIMAL(10,2),
	 CPF_CLIENTE VARCHAR(11),
	 PRIMARY KEY(NUM_CONTA_C),
	 FOREIGN KEY (CPF_CLIENTE) REFERENCES CLIENTE(CPF)
);

CREATE TABLE CONTA_POUPANCA( 
	NUM_CONTA_P VARCHAR(11) UNIQUE,
	DATA_ABERTURA DATE,
	SALDO DECIMAL(10,2),
	CPF_CLIENTE VARCHAR(11),
	FOREIGN KEY (CPF_CLIENTE) REFERENCES CLIENTE(CPF),
	PRIMARY KEY(NUM_CONTA_P)
);

CREATE TABLE TIPOS_CARTOES_CREDITO(
	TIPO_CARTAO VARCHAR(10),
	TAXA_ANUAL DECIMAL(4,2),
	LIMITE_INICIAL DECIMAL (10,2),
	PRIMARY KEY(TIPO_CARTAO)
);

CREATE TABLE CARTOES_DE_CREDITO(
	ID_CARTAO INTEGER NOT NULL UNIQUE AUTO_INCREMENT,
	NUM_CONTA_C VARCHAR(11),
	TIPO_CARTAO VARCHAR(10),
	DATA_EMISSAO DATE,
	STATUS BOOLEAN,
	NUM_CARTAO VARCHAR(16), -- NUMERO DE CARTAO 16 digitos--
	COD_SEGURANCA VARCHAR(3),
	NOME_NO_CARTAO VARCHAR(30),
	LIMITE DECIMAL(10,2),
	PRIMARY KEY(ID_CARTAO),
	FOREIGN KEY(NUM_CONTA_C) REFERENCES CONTA_CORRENTE(NUM_CONTA_C),
 	FOREIGN KEY(TIPO_CARTAO) REFERENCES TIPOS_CARTOES_CREDITO(TIPO_CARTAO)
);

CREATE TABLE FATURAS_CC(
	ID_FATURA INTEGER NOT NULL AUTO_INCREMENT,
	DATA DATE, VALOR DECIMAL(10,2),
	PAGO BOOLEAN,
	ID_CARTAO INTEGER NOT NULL,
	PRIMARY KEY(ID_FATURA), FOREIGN KEY(ID_CARTAO) REFERENCES CARTOES_DE_CREDITO(ID_CARTAO)
);

CREATE TABLE CARTOES_DE_DEBITO( 
	ID_CARTAO INTEGER NOT NULL UNIQUE AUTO_INCREMENT,
	NUM_CONTA_P VARCHAR(11),
	STATUS BOOLEAN,
	NUM_CARTAO_D VARCHAR(16),
	DATA_VALIDADE DATE,
	DATA_EMISSAO DATE,
	NOME_NO_CARTAO VARCHAR(30),
	COD_SEGURANCA INTEGER NOT NULL,
	PRIMARY KEY(ID_CARTAO),
	FOREIGN KEY(NUM_CONTA_P) REFERENCES CONTA_POUPANCA(NUM_CONTA_P)
); 






